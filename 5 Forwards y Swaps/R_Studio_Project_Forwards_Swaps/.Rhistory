i <- 0.10/12 # tasa efectiva por periodo mensual
n <- 20*12 # 20 anios en meses
pago <- L /((1-(1+i)^(-n))/i) # Pago mensual
# Tabla de Amortización:
ASF <- data.frame(
Tiempo=seq(0,n,by=1),   # ASF: Amortización Sistema Frances
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASF$Pago[k+1] <- 0
ASF$Interes[k+1] <- 0
ASF$Capital[k+1] <- 0
ASF$Balance[k+1] <- L
}else{
ASF$Pago[k+1] <- pago # pago 'nivelado' para todos los periodos de tiempo
ASF$Interes[k+1] <- ASF$Balance[k]*i # tasa efectiva mensual
# nota: esta tabla es simplificada en el pago de intereses en forma mensual
# pero los bancos calculan los intereses por dias exactos en cada mes.
ASF$Capital[k+1] <- ASF$Pago[k+1]-ASF$Interes[k+1]
ASF$Balance[k+1] <- ASF$Balance[k]-ASF$Capital[k+1]
}
}
sum(ASF$Pago)
sum(ASF$Interes)
sum(ASF$Capital)
L <- 2000000
i <- 0.10/12
n <- 20*12
capital <- L / n
ASA <- data.frame(   # Amortización Sistema Alemán
Tiempo=seq(0,n,by=1),
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASA$Pago[k+1] <- 0
ASA$Interes[k+1] <- 0
ASA$Capital[k+1] <- 0
ASA$Balance[k+1] <- L
}else{
ASA$Capital[k+1] <- capital
ASA$Interes[k+1] <- ASA$Balance[k]*i
ASA$Pago[k+1] <- ASA$Capital[k+1]+ASA$Interes[k+1]
ASA$Balance[k+1] <- ASA$Balance[k]-ASA$Capital[k+1]
}
}
sum(ASA$Pago)
sum(ASA$Interes)
sum(ASA$Capital)
View(ASA)
View(ASF)
View(ASA)
sum(ASF$Interes) - sum(ASA$Interes)
sum(ASF$Interes) - sum(ASA$Interes)
L <- 2000000
i <- 0.10/12
n <- 20*12
L <- 2000000
i <- 0.10/12
n <- 20*12
ASEU <- data.frame(
Tiempo=seq(0,n,by=1),
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
View(ASEU)
L <- 2000000
i <- 0.10/12
n <- 20*12
ASEU <- data.frame(   # ASEU: Amortización Sistema Americano (Estados Unidos)
Tiempo=seq(0,n,by=1),
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASEU$Pago[k+1] <- 0
ASEU$Interes[k+1] <- 0
ASEU$Capital[k+1] <- 0
ASEU$Balance[k+1] <- L
}else{
if(k==n){ # ultimo pago es diferente por que se paga el 100% del capital
ASEU$Interes[k+1] <- ASEU$Balance[k]*i
ASEU$Pago[k+1] <- ASEU$Interes[k+1]+L
ASEU$Capital[k+1] <- ASEU$Pago[k+1]-ASEU$Interes[k+1]
ASEU$Balance[k+1] <- ASEU$Balance[k]-ASEU$Capital[k+1]
}else{
ASEU$Interes[k+1] <- ASEU$Balance[k]*i
ASEU$Pago[k+1] <- ASEU$Interes[k+1]
ASEU$Capital[k+1] <- ASEU$Pago[k+1]-ASEU$Interes[k+1]
ASEU$Balance[k+1] <- ASEU$Balance[k]-ASEU$Capital[k+1]
}
}
}
sum(ASEU$Pago)
sum(ASEU$Interes)
sum(ASEU$Capital)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1)
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, label="Balance")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
labels()
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, label="Balance")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance disminuye en el tiempo")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance disminuye en el tiempo",
xlabel = "Tiempo")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance disminuye en el tiempo",
xlab = "Tiempo")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance disminuye en el tiempo",
xlab = "Tiempo", ylab = "Balance")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col=1, main ="Balance disminuye en el tiempo",
xlab = "Tiempo (meses)", ylab = "Balance ($)")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col=2)
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col=3)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col="black", main ="Balance disminuye en el tiempo",
xlab = "Tiempo (meses)", ylab = "Balance ($)")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col="red")
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col="blue")
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col="black", main ="Balance disminuye en el tiempo",
xlab = "Tiempo (meses)", ylab = "Balance ($)")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col="red")
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col="blue")
labels(c("a","b","c"))
labels("a","b","c")
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col="black", main ="Balance disminuye en el tiempo",
xlab = "Tiempo (meses)", ylab = "Balance ($)")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col="red")
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col="blue")
labels("a","b","c")
labels.default()
#Caso 1. El activo no genera rendimiento
st <- 100000 #cuanto vale el subyacente en el tiempo t
t <- 180 #días
PFt <- st # Precio del prepago o Pre-paid Forward al tiempo t=0, debera
#Caso 2. El activo genera plusvalía a una tasa r
st <- 100000
t <- 180
r <- 0.20
PFt_simple <- st/(1+r*t/360) #interes simple
PFt_compuesto <- st*(1+r)^(-t/360) #interes compuesto
PFt_continuo <- st*exp(-r*t/360) #fuerza de interes
#i.e. dividendo, ya es dinero por lo que no se
#puede traer a Valor Presente con la tasa de plusvalia 'r'
#pero si con 'i' que es la tasa de interes de referencia i.e. CETE, TIIE, etc.
st <- 100000
t <- 180
r <- 0.20 #tasa de plusvalía
i <- 0.10 #tasa de interes
p <- 10000 # el pago generado del activo
tp <- 90 # tiempo del pago del flujo de efectivo
# En este ejercicio solo es un unico pago en 90 dias, traerlo a t=0 o VP
PFt_simple <- st-p/(1+i*tp/360)
PFt_compuesto <- st-p*(1+i)^(-tp/360)
PFt_continuo <- st-p*exp(-i*tp/360)
# En este ejercicio solo es un unico pago en 90 dias, traerlo a t=0 o VP
PFt_simple <- st-p/(1+i*tp/360)
PFt_compuesto <- st-p*(1+i)^(-tp/360)
PFt_continuo <- st-p*exp(-i*tp/360)
# En este ejercicio solo es un unico pago en 90 dias, traerlo a t=0 o VP
PFt_simple <- st-p/(1+i*tp/360)
PFt_compuesto <- st-p*(1+i)^(-tp/360)
PFt_continuo <- st-p*exp(-i*tp/360)
#i.e. dividendo, ya es dinero por lo que no se
#puede traer a Valor Presente con la tasa de plusvalia 'r'
#pero si con 'i' que es la tasa de interes de referencia i.e. CETE, TIIE, etc.
st <- 100000
t <- 180
i <- 0.10 #tasa de interes
p <- 10000 # el pago generado del activo ($)
tp <- 90 # tiempo del pago del flujo de efectivo.
# En este ejercicio solo es un unico pago en 90 dias, traerlo a t=0 o VP
PFt_simple <- st-p/(1+i*tp/360)
PFt_compuesto <- st-p*(1+i)^(-tp/360)
PFt_continuo <- st-p*exp(-i*tp/360)
#Caso 4. El activo si genera plusvalía y genera un pago o flujo de efectivo
st <- 100000
t <- 180
r <- 0.20 #tasa de plusvalía
i <- 0.10 #tasa de interes
p <- 10000
tp <- 90
# En este ejercicio solo es un único pago en 90 días, traerlo a t=0 o VP con la tasa "i",
# aquí si hay plusvalía por lo que tambien hay que traer a VP el precio del
# subyacente con la tasa "r".
PFt_simple <- st/(1+r*t/360)-p/(1+i*tp/360)
PFt_compuesto <- st*(1+r)^(-t/360)-p*(1+i)^(-tp/360)
PFt_continuo <- st*exp(-r*t/360)-p*exp(-i*tp/360)
Payoff <- function(st,Ft,op){
if(op==0){
p <- st-Ft # Long
}else{
p <- Ft-st # short
}
return(p)
}
st <- seq(0,100,by=0.5)  #Precio del Subyacente
Ft <- 40 # precio pactado
Plong <- Payoff(st,Ft,0)  # Payoff Long
Pshort <- Payoff(st,Ft,1) # Payoff Short
st <- seq(0,100,by=0.5)  #Precio del Subyacente
Ft <- 40 # precio pactado
Plong <- Payoff(st,Ft,0)  # Payoff Long
Pshort <- Payoff(st,Ft,1) # Payoff Short
plot(x=st,y=Plong,type = "l",col="blue")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft,type="l",col="red")
abline(h=0,type="l",col="red")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft,type="l",col="red")
abline(h=0,type="l",col="red")
st <- seq(0,100,by=0.5)  #Precio del Subyacente
Ft <- 40 # precio pactado
Plong <- Payoff(st,Ft,0)  # Payoff Long
Pshort <- Payoff(st,Ft,1) # Payoff Short
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft,type="l",col="red")
abline(h=0,type="l",col="red")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft,col="red")
abline(h=0,col="red")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft)#,col="red")
abline(h=0)#,col="red")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft),col="black")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
plot(x=st,y=Plong,type = "l",col="blue", xlab = "Spot Preice St", ylab = "Payoff ($)", main = "Payoff P/L Diagram Long vs Short"
abline(v=Ft ,col="black")
plot(x=st,y=Plong,type = "l",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff P/L Diagram Long vs Short")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
plot(x=st,y=Plong,type = "l",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff (P/L) Diagram Long vs Short")
lines(x=st,y=Pshort,type = "l",col="green")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
plot(x=st,y=Plong,type = "l",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff (P/L) Diagram Long vs Short")
lines(x=st,y=Pshort,type = "l",col="orange")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
#A1. Compras con Apalancamiento
# Liquidas en tiempo t=T y recibes el activo en tiempo t0
#############################
# Sistema Frances
#############################
# Producto o crédito hipotecario tradicional
# cuotas niveladas: el VP de los Pagos de las mensualidades = Préstamo
# L = P*a_n
# despejando P tenemos:
# P = L / a_n
# a_n: anualidad n-periodos de tiempo
L <- 2000000 # Loan (prestamo) i.e. hipotecario
i <- 0.10/12 # tasa efectiva por periodo mensual
n <- 20*12 # 20 anios en meses
pago <- L /((1-(1+i)^(-n))/i) # Pago mensual
# Tabla de Amortización:
ASF <- data.frame(
Tiempo=seq(0,n,by=1),   # ASF: Amortización Sistema Frances
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASF$Pago[k+1] <- 0
ASF$Interes[k+1] <- 0
ASF$Capital[k+1] <- 0
ASF$Balance[k+1] <- L
}else{
ASF$Pago[k+1] <- pago # pago 'nivelado' para todos los periodos de tiempo
ASF$Interes[k+1] <- ASF$Balance[k]*i # tasa efectiva mensual
# nota: esta tabla es simplificada en el pago de intereses en forma mensual
# pero los bancos calculan los intereses por dias exactos en cada mes.
ASF$Capital[k+1] <- ASF$Pago[k+1]-ASF$Interes[k+1]
ASF$Balance[k+1] <- ASF$Balance[k]-ASF$Capital[k+1]
}
}
sum(ASF$Pago)
sum(ASF$Interes)
sum(ASF$Capital)
#############################
# Sistema Alemán
#############################
# Producto hipotecario de liquidez
# Cuotas a capital niveladas, es decir el préstamo es el numero de aportaciones
# a capital que se realicen.
# L = capital * n
# despejando capital:
# capital = L / n
L <- 2000000
i <- 0.10/12
n <- 20*12
capital <- L / n
ASA <- data.frame(   # ASA: Amortización Sistema Alemán
Tiempo=seq(0,n,by=1),
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASA$Pago[k+1] <- 0
ASA$Interes[k+1] <- 0
ASA$Capital[k+1] <- 0
ASA$Balance[k+1] <- L
}else{
ASA$Capital[k+1] <- capital
ASA$Interes[k+1] <- ASA$Balance[k]*i
ASA$Pago[k+1] <- ASA$Capital[k+1]+ASA$Interes[k+1]
ASA$Balance[k+1] <- ASA$Balance[k]-ASA$Capital[k+1]
}
}
sum(ASA$Pago)
sum(ASA$Interes)
sum(ASA$Capital)
# Se pago menos interes con el sistema Alemán que con el Frances ($623,770.6)
#############################
# Sistema Americano
#############################
# Se pagan intereses y el capital al final.
# Para créditos de capital de trabajo, créditos de la cartera comercial a
# corto plazo.
# No es usual para créditos hipotecarios porque son a largo plazo.
# Créditos "Bullet" que son como un Bono Cupón cero.
L <- 2000000
i <- 0.10/12
n <- 20*12
ASEU <- data.frame(   # ASEU: Amortización Sistema Americano (Estados Unidos)
Tiempo=seq(0,n,by=1),
Pago=NA,
Interes=NA,
Capital=NA,
Balance=NA)
for(k in 0:n){
if(k==0){
ASEU$Pago[k+1] <- 0
ASEU$Interes[k+1] <- 0
ASEU$Capital[k+1] <- 0
ASEU$Balance[k+1] <- L
}else{
if(k==n){ # ultimo pago es diferente por que se paga el 100% del capital
ASEU$Interes[k+1] <- ASEU$Balance[k]*i
ASEU$Pago[k+1] <- ASEU$Interes[k+1]+L
ASEU$Capital[k+1] <- ASEU$Pago[k+1]-ASEU$Interes[k+1]
ASEU$Balance[k+1] <- ASEU$Balance[k]-ASEU$Capital[k+1]
}else{
ASEU$Interes[k+1] <- ASEU$Balance[k]*i
ASEU$Pago[k+1] <- ASEU$Interes[k+1]
ASEU$Capital[k+1] <- ASEU$Pago[k+1]-ASEU$Interes[k+1]
ASEU$Balance[k+1] <- ASEU$Balance[k]-ASEU$Capital[k+1]
}
}
}
sum(ASEU$Pago)
sum(ASEU$Interes)
sum(ASEU$Capital)
# Con este sistema se pagarían muchísimos Intereses ($6,000,000)
# Habria que agregar:
#   Costo Administrativo (costo por apertura)
#   Costo de seguro de vida del que paga,
#   costo de seguro de danios,
#   IVA a los intereses.
#   La suma de lo anterior nos daria la CAT (tasa anual total)
#   i.e. del 10% se iría al 11.5% aprox. la tasa real
# Gráfico que muestra la disminución del Balance en el tiempo (meses)
plot(x=ASA$Tiempo,y=ASA$Balance,type="l", col="black",   # Alemán
main ="Balance disminuye en el tiempo",
xlab = "Tiempo (meses)", ylab = "Balance ($)")
lines(x=ASF$Tiempo,y=ASF$Balance,type="l",col="red")     # Frances
lines(x=ASEU$Tiempo,y=ASEU$Balance,type="l",col="blue")  # Americano
# Hace sentido el gráfico porque en el Alemán los pagos a capital son Constantes,
# en el Frances los pagos a capital van aumentando con el tiempo
# en el Americano el balance se finiquita al final.
plot(x=st,y=Plong,type = "p",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff (P/L) Diagram Long vs Short")
lines(x=st,y=Pshort,type = "l",col="orange")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
plot(x=st,y=Plong,type = "o",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff (P/L) Diagram Long vs Short")
plot(x=st,y=Plong,type = "l",col="blue",
xlab = "Spot Preice St",
ylab = "Payoff ($)",
main = "Payoff (P/L) Diagram Long vs Short")
lines(x=st,y=Pshort,type = "l",col="orange")
abline(v=Ft ,col="black")
abline(h=0  ,col="black")
# Pago dividendos de forma continua
s0 <- 60
acciones <- 100
r <- 0.05 #tasa de plusvalia
d <- 0.02 #tasa de dividendo
t <- 90 #dias
Ft.sim <- s0*acciones*(1+(r-d)*t/360)
Ft.com <- s0*acciones*(1+(r-d))^(t/360)
Ft.cont <- s0*acciones*exp((r-d)*t/360)
cat(Ft.sim,Ft.com,Ft.cont)
#Pago de dividendos de forma discreta
s0 <- 60
acciones <- 100
r <- 0.05 #tasa de plusvalia
d <- 1 #monto de dividendo
i <- 0.10 #tasa de interes
t <- 90 #dias
td <- 30 #periodo de pago del dividendo
Ft.sim <- s0*acciones*(1+(r)*t/360)-d*acciones*(1+i*(t-td)/360)
Ft.com <- s0*acciones*(1+(r))^(t/360)-d*acciones*(1+i)^((t-td)/360)
Ft.cont <- s0*acciones*exp((r)*t/360)-d*acciones*exp(i*(t-td)/360)
cat(Ft.sim,Ft.com,Ft.cont)
library(quantmod) #finanzas cuantitativas
cartera = c("AMZN")
getSymbols(cartera, src="yahoo", from="2024-01-01", to="2025-05-30") # ver Data window
d1 = data.frame(Precio=AMZN$AMZN.Close, Rend=NA)
# la libreria entrega una Serie de tiempo, aqui lo convertimos a DataFrame.
# Tomamos el precio de Cierre no el Ajustado porque no incluye los eventos corporativos como pago de dividendos, etc.,
# el precio ajustado se ve al siguiente dia, cuando abre el mercado ya ajusta por los eventos corporativos,
# es basicamente para tener congruencia en todos los datos
colnames(d1) = c("Precio", "Rend")
# Análisis de la Serie
chartSeries(AMZN, type = "candlesticks", theme = chartTheme('white'))
addSMA(n=10, on=1, col='blue')
addBBands(n=10, sd=2)
# Proyeccion del Activo Financiero con un proceso Estocastico de Norbert Weiner
n = length(d1$Precio)
for(k in 2:n){
d1$Rend[k] = d1$Precio[k]/d1$Precio[k-1] - 1
}
# Supuesto de Normalidad para Procesos Estocasticos
plot(d1$Rend[2:n], type="l", col="blue")
abline(h=0, col="red")
abline(h=0.05, col="red") # intervalos de confianza al +/-5%
abline(h=-0.05, col="red")
# Histograma
hist(d1$Rend[2:n], breaks =  "Sturges")
hist(d1$Rend[2:n], breaks =  "Scott")
hist(d1$Rend[2:n], breaks =  "freedman-diaconis")
# Definir datos:
m = mean(d1$Rend[2:n])
s = sd(d1$Rend[2:n])
S0 = d1$Precio[n]
t = 1 # tiempo expresado en dias, hare prediccion diaria
esc = 1000 # numero de posibles escenarios
np = 100 # numero de dias de proyeccion en adelante
# Prediccion del Precio para distintas trayectorias
# Precio del activo para 100 dias, 1000 posibles escenarios.
stm = matrix(data=NA, nrow = np, ncol = esc) # [100 x 1000] stm = Matriz de precios S_t
# llenar la matriz stm
set.seed(600)
for(j in 1:esc){ # numero de escenarios
for(k in 1:np){ # numero de dias de proyeccion
if(k==1){
stm[k,j] = S0
}else{
stm[k,j] = stm[k-1,j]+stm[k-1,j]*(m*t+s*sqrt(t)*rnorm(1,mean=0,sd=1)) # al final agregamos el 'Ruido Blanco' del proceso Estocastico
}
}
}
# Proyección del proceso estocástico del precio del activo financiero en los próximos 100 dias
plot(stm[,1], type = "l", col=1, ylim = c(min(stm), max(stm))) # para una trayectoria
for(k in 2:esc){
lines(stm[,k], type = "l", col=k)
} # Ver la tendencia de la media si es a la baja o a la alta.
# Opcion1: Precio forward con el Proceso de Weiner
hist(stm[np,], breaks = "freedman-diaconis")  # histograma de los posibles precios en el dia 100
F0t_Weiner = mean(stm[np,]) # $228.06 usd. El precio pronosticado despues de 100 dias por el Modelo de Weiner
# Opcion 2: Precio teorico con tasa de plusvalia (un modelo mas sencillo)
r = mean(d1$Rend[2:n]) # obtener una tasa promedio de los historicos del rendimiento, tasa de Plusvalia
t = 100
F0t_Plusvalia = d1$Precio[n]*exp(r*t) # 229.600usd. El precio Forward (pronosticado) despues de 100 dias por el Modelo de Plusvalia
